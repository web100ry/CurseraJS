(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"23qH":function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var d=(u=s=function(e){function OnDemandDiscussionQuestions(){return(0,r.default)(this,OnDemandDiscussionQuestions),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(OnDemandDiscussionQuestions,e),OnDemandDiscussionQuestions}(_interopRequireDefault(e("W3Lk")).default),s.RESOURCE_NAME="onDemandDiscussionQuestions.v1",u);module.exports=d},"2jK5":function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p=_interopRequireDefault(e("W3Lk")),d,c=_interopRequireDefault(e("FGtb"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var f=(u=s=function(e){function OnDemandDiscussionPrompts(){return(0,r.default)(this,OnDemandDiscussionPrompts),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(OnDemandDiscussionPrompts,e),OnDemandDiscussionPrompts}(p.default),s.RESOURCE_NAME="onDemandDiscussionPrompts.v1",s.DEFAULT_INCLUDES=["question"],s.DEFAULT_FIELDS=["promptType",c.default.RESOURCE_NAME+"("+c.default.DEFAULT_FIELDS.join(",")+")"],u);module.exports=f},BMks:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p,d,c;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var f=e("sbe7"),m,h=e("Zihe").Link,_=e("VYij"),g=e("wiyT"),v=e("CWYE"),D=e("BDKN"),y,E=e("hN99").buildUrlForDiscussionPrompt,R=e("y1LI"),I=e("rcV8"),q=e("jsrg"),P=e("8cuT"),S=e("ZEYT"),b=e("m88N"),C=e("g21z"),w,x=e("V4Vm").formatCount,T,U=e("SaLm").answerSorts,A=e("GP6s"),M=4,N=(u=s=function(e){function RespondedLearnersImage(){return(0,r.default)(this,RespondedLearnersImage),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(RespondedLearnersImage,e),RespondedLearnersImage.prototype.renderMorePeopleImage=function renderMorePeopleImage(){if(this.props.responseCount>4){var e=x(this.props.responseCount-4,!0);return f.createElement("li",{className:"bgcolor-black-g3"},f.createElement("div",{className:"horizontal-box align-items-absolute-center num-responder-images caption-text"},"+",e))}return null},RespondedLearnersImage.prototype.render=function render(){var e=this.props.answers,t=e&&e.filter(function(e,t){return t<4}).map(function(e){return{image:e.creator.photoUrl,name:e.creator.fullName}});if(!t||0===t.length)return null;return f.createElement("ul",{className:"nostyle horizontal-box align-items-absolute-center learner-image-list"},t.map(function(e){var t=e.name,r=e.image;return f.createElement("li",{key:t},f.createElement(C,{width:32,height:32,fullName:t,profileImageUrl:r}))}),this.renderMorePeopleImage())},RespondedLearnersImage}(f.Component),s.propTypes={responseCount:f.PropTypes.number.isRequired,answers:f.PropTypes.array},u),L=(p=l=function(e){function Input(){return(0,r.default)(this,Input),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(Input,e),Input.prototype.render=function render(){var e=this.props,t=e.question,r=e.savingState,o=e.placeholder;return f.createElement("div",{className:"horizontal-box align-items-left theme-light c-prompt-card"},f.createElement(b,null),f.createElement(S,{hideFollow:!0,question:t,parentPost:t,savingState:r,placeholder:A(o)}))},Input}(f.Component),l.propTypes={placeholder:f.PropTypes.string.isRequired,question:f.PropTypes.object.isRequired,savingState:f.PropTypes.string.isRequired},p),F=function(e){function Saving(){return(0,r.default)(this,Saving),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(Saving,e),Saving.prototype.render=function render(){return f.createElement("div",{className:"horizontal-box align-items-absolute-center bgcolor-white c-prompt-card color-hint-text"},f.createElement(R,{name:"spinner",className:"cif-spin"}),f.createElement("span",{className:"caption-text"},A("Submitting Your Response")))},Saving}(f.Component),k=(c=d=function(e){function Completed(){return(0,r.default)(this,Completed),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(Completed,e),Completed.prototype.render=function render(){return f.createElement("div",{className:"vertical-box align-items-absolute-center bgcolor-white c-prompt-card"},f.createElement("span",{className:"color-secondary-text"},A("Your response has been submitted. Engage and discuss with other learners below!")),this.props.url&&f.createElement("button",{className:"secondary c-prompt-link-button"},f.createElement(h,{className:"nostyle",to:this.props.url},A("View My Response"))))},Completed}(f.Component),d.propTypes={showLink:f.PropTypes.bool,questionId:f.PropTypes.string.isRequired,url:f.PropTypes.string},c);module.exports={Input:L,Saving:F,Completed:_.compose(I(function(e){if(e.showLink){var t=v("/api/onDemandCourseForumAnswers.v1/",{type:"rest"}),r=[e.userId,e.courseId,e.questionId].join("~"),o=(new D).addQueryParam("q","byForumQuestionId").addQueryParam("userCourseQuestionId",r).addQueryParam("sort","createdAtAsc").addQueryParam("creatorId",e.userId).toString();return g(t.get(o)).then(function(e){if(!e.elements.length)return{url:void 0};var t;return{url:E(e.elements[0].forumAnswerId)}})}return g({url:void 0})}))(k),RespondedLearnersImage:_.compose(P(["ThreadDetailsStore"],function(e,t){var r=e.ThreadDetailsStore,o=t.questionId,a=t.page;return{answers:r.getReplies(o,a,U.newestSort)||[]}}))(N)}},FGtb:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var d=(u=s=function(e){function OnDemandDiscussionPromptQuestions(){return(0,r.default)(this,OnDemandDiscussionPromptQuestions),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(OnDemandDiscussionPromptQuestions,e),OnDemandDiscussionPromptQuestions}(_interopRequireDefault(e("W3Lk")).default),s.RESOURCE_NAME="onDemandDiscussionPromptQuestions.v1",s.DEFAULT_FIELDS=["content","creatorId","createdAt","forumId","sessionId","lastAnsweredBy","lastAnsweredAt","totalAnswerCount","topLevelAnswerCount","viewCount"],u);module.exports=d},HKJh:function(module,exports,e){var t=e("Uhh9"),r;"string"==typeof t&&(t=[[module.i,t,""]]);var o={transform:void 0},a=e("aET+")(t,o);t.locals&&(module.exports=t.locals)},K8LW:function(module,exports,e){},Maio:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u=_interopRequireDefault(e("uxKl")),l,p=_interopRequireDefault(e("CkRy"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var d=e("sbe7"),c=e("geBo");e("WdIA");var f=function(e){function DiscussionPromptWrapper(){return(0,r.default)(this,DiscussionPromptWrapper),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(DiscussionPromptWrapper,e),DiscussionPromptWrapper.prototype.render=function render(){var e=this.props,t=e.computedItem,r=e.itemMetadata;return d.createElement(p.default,{className:"rc-DiscussionPromptWrapper",hideFeedback:!0},d.createElement("div",{className:"discussion-prompt-content"},d.createElement("div",{className:"vertical-box align-items-vertical-center"},d.createElement("div",null,d.createElement("span",{className:"cif-stack cif-2x"},d.createElement("i",{className:"cif-circle cif-stack-2x c-prompt-icon"}),d.createElement("i",{className:"cif-comment cif-stack-1x cif-inverse comment-icon"}))),d.createElement("h4",{className:"c-prompt-title"},t.name)),d.createElement(c,{itemMetadata:r,previouslyCompleted:t.isCompleted})))},DiscussionPromptWrapper}(d.Component);module.exports=f},RX7l:function(module,exports,e){var t=e("soQW"),r;"string"==typeof t&&(t=[[module.i,t,""]]);var o={transform:void 0},a=e("aET+")(t,o);t.locals&&(module.exports=t.locals)},TpA2:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("VYij")),o,a=_interopRequireDefault(e("PStO")),n,i=_interopRequireDefault(e("jsrg")),s,u=_interopRequireDefault(e("VXRf")),l=e("PDuk"),p,d=_interopRequireDefault(e("sQ/U")),c,f=_interopRequireDefault(e("2jK5")),m,h=_interopRequireDefault(e("FGtb")),g=e("SaLm"),v,D=_interopRequireDefault(e("bmRM"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var y=r.default.compose(a.default.createContainer(function(e){var t=e.itemMetadata,r=t.getId(),o=t.get("course").get("id");return{prompt:f.default.get((0,l.tupleToStringKey)([d.default.get().id,o,r]),{includes:f.default.DEFAULT_INCLUDES,fields:f.default.DEFAULT_FIELDS})}}),a.default.createContainer(function(e){var t=e.prompt;if(!t||!t.promptType)return{};var r=t.promptType.definition.courseItemForumQuestionId,o=[t.userId,r].join("~");return{discussionPromptQuestion:h.default.localGet(o,{fields:h.default.DEFAULT_FIELDS})}}),(0,i.default)(function(e){var t;return!!e.discussionPromptQuestion}),(0,u.default)(function(e){var t=e.discussionPromptQuestion,r=t&&t.id.split("~")[3],o;return{isLoaded:!0,questionId:r,question:{id:r,questionId:r,type:"question",forumType:g.naptimeForumTypes.rootForumType},promptContent:t&&t.content.details,learnerCount:t&&t.totalAnswerCount}}))(D.default);module.exports=y},Uhh9:function(module,exports,e){},WdIA:function(module,exports,e){var t=e("t1rh"),r;"string"==typeof t&&(t=[[module.i,t,""]]);var o={transform:void 0},a=e("aET+")(t,o);t.locals&&(module.exports=t.locals)},afBN:function(module,exports,e){},b7BL:function(module,exports,e){var t=e("K8LW"),r;"string"==typeof t&&(t=[[module.i,t,""]]);var o={transform:void 0},a=e("aET+")(t,o);t.locals&&(module.exports=t.locals)},bmRM:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var l=e("sbe7"),p=e("sQ/U"),d=e("kvW3"),c=d.FormattedNumber,f=d.FormattedMessage,m,h=e("wvdd").fetchAnswers,g=e("BZ+2"),v,D=e("0jv7").savingStates,y,E=e("SaLm").answerSorts,R=e("y1LI"),I=e("JUgE"),q=e("EWSN"),P=e("BMks"),S=P.Input,b=P.Saving,C=P.Completed,w=P.RespondedLearnersImage,x=e("GP6s");e("RX7l");var T=(u=s=function(e){function DiscussionPrompt(t,o){(0,r.default)(this,DiscussionPrompt);var n=(0,a.default)(this,e.call(this,t,o));return n.state={savingState:D.UNCHANGED,forumError:!1},n}return(0,i.default)(DiscussionPrompt,e),DiscussionPrompt.prototype.componentDidMount=function componentDidMount(){this.props.isLoaded&&(this.setState({questionId:this.props.questionId}),this.fetchAnswers(this.props.questionId,E.newestSort,this.props.page))},DiscussionPrompt.prototype.componentWillReceiveProps=function componentWillReceiveProps(e){var t=this.state.questionId;this.setState({savingState:e.savingStates[t]||D.UNCHANGED}),t&&this.props.savingStates[t]===D.SAVING&&e.savingStates[t]===D.SAVED&&this.fetchAnswers(t,E.newestSort,this.props.page)},DiscussionPrompt.prototype.componentDidUpdate=function componentDidUpdate(e,t){var r=this.props,o=r.questionId,a=r.page;e.page!==a&&this.fetchAnswers(o,E.newestSort,a)},DiscussionPrompt.prototype.fetchAnswers=function fetchAnswers(e,t,r){var o=this.props,a=o.courseId,n=o.currentForum;this.context.executeAction(h,{questionId:e,sort:t,page:r,contextId:a,userId:p.get().id,forumType:n.forumType.typeName})},DiscussionPrompt.prototype.renderLoading=function renderLoading(){return l.createElement("div",{className:"vertical-box align-items-vertical-center"},l.createElement(R,{name:"spinner",className:"cif-spin cif-3x"}))},DiscussionPrompt.prototype.renderInput=function renderInput(){var e=this.props,t=e.learnerCount,r=e.question,o=e.questionId,a=e.page,n=t>0;return l.createElement("div",null,l.createElement("div",{className:"color-hint-text participation-text"},x("Participation is optional")),l.createElement(S,{savingState:this.state.savingState,question:r,placeholder:x("Type your response here...")}),l.createElement(w,{responseCount:t,questionId:o,page:a}),l.createElement("div",{className:"horizontal-box align-items-absolute-center caption-text color-secondary-text"},n?l.createElement("div",null,l.createElement(c,{value:t})," ",l.createElement(f,{message:x("{learnerCount, plural, =1 { learner has} other { learners have}} submitted a response."),learnerCount:t})):l.createElement("div",null,x("Be the first to submit a response"))))},DiscussionPrompt.prototype.renderError=function renderError(){return l.createElement("div",{className:"horizontal-box align-items-absolute-center bgcolor-white c-prompt-card"},l.createElement("span",{className:"caption-text color-secondary-text"},x("Sorry, we were unable to retrieve a forum.")))},DiscussionPrompt.prototype.renderCompleted=function renderCompleted(){var e=this.props,t=e.questionId,r=e.previouslyCompleted,o=e.page,a=e.currentForum,n=e.answerId,i=e.currentForumUrl,s=e.courseId;return l.createElement("div",null,l.createElement(C,{showLink:r,questionId:t,userId:p.get().id,courseId:s}),l.createElement("div",{className:"c-thread-container"},l.createElement(q,{sort:E.newestSort,page:o,forumId:a.id,questionId:t,answerId:n,forumLink:i})))},DiscussionPrompt.prototype.renderContent=function renderContent(){var e=this.state.savingState;if(e===D.SAVED||this.props.previouslyCompleted)return this.renderCompleted();if(e===D.UNCHANGED)return this.renderInput();if(e===D.SAVING)return l.createElement(b,null);return!1},DiscussionPrompt.prototype.renderBody=function renderBody(){var e=this.props.promptContent;return l.createElement("div",null,l.createElement("span",null,l.createElement(I,{cml:e})),this.renderContent())},DiscussionPrompt.prototype.render=function render(){var e=this.props.isLoaded,t=this.state.forumError;return l.createElement("div",{className:"rc-DiscussionPrompt"},!t&&(e?this.renderBody():this.renderLoading()),t&&this.renderError())},DiscussionPrompt}(l.Component),s.propTypes={savingStates:l.PropTypes.object.isRequired,previouslyCompleted:l.PropTypes.bool.isRequired,page:l.PropTypes.number,answerId:l.PropTypes.string,courseId:l.PropTypes.string,currentForum:l.PropTypes.instanceOf(g),currentForumUrl:l.PropTypes.string,questionId:l.PropTypes.string,question:l.PropTypes.object,promptContent:l.PropTypes.object,learnerCount:l.PropTypes.number,isLoaded:l.PropTypes.bool},s.contextTypes={executeAction:l.PropTypes.func.isRequired,router:l.PropTypes.object.isRequired},u);module.exports=T},gXau:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("wiyT")),o,a=_interopRequireDefault(e("CWYE")),n,i=_interopRequireDefault(e("BDKN")),s,u=_interopRequireDefault(e("ma43"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var l=(0,a.default)("/api/onDemandClassmateProfiles.v1",{type:"rest"});exports.initProfileStore=function(e,t){var o=t.authenticated,a=t.courseId,n=t.externalId,i=t.userId;if(!e.getStore("ProfileStore").hasLoaded()&&o){var s=[e.executeAction(exports.getSocialProfile,{courseId:a,externalId:n})];return i&&s.push((0,r.default)(u.default.get(i.toString(),{data:{fields:"fullName"}})).then(function(t){e.dispatch("INIT_PROFILE_STORE",t)})),r.default.all(s)}return(0,r.default)()},exports.getUserProfile=function(e,t){var o=t.authenticated,a=t.userId;if(o&&a)return(0,r.default)(u.default.get(a.toString(),{data:{fields:"fullName"}})).then(function(t){e.dispatch("RECEIVE_USER_PROFILE",t)});return(0,r.default)()},exports.getSocialProfile=function(e,t){var o=t.courseId,a=t.externalId,n=(new i.default).addQueryParam("courseId",o).addQueryParam("q","byExternalIds").addQueryParam("externalUserIds",a).addQueryParam("includes","userId,_links");return(0,r.default)(l.get(n.toString())).then(function(t){e.dispatch("RECEIVE_SOCIAL_PROFILE",t)})},exports.updateLocation=function(e){var t=e.getStore("ProfileStore").profile;return t.location=location,e.dispatch("UPDATE_LOCATION_START",location),(0,r.default)(u.default.put(t.userId+"",{data:t})).then(function(t){e.dispatch("UPDATE_LOCATION_SUCCESS",t)})},exports.updateProfileImage=function(e,t){var o=t.authenticated,a=t.userId,n=t.photos;if(o)return(0,r.default)(u.default.get(a.toString(),{})).then(function(t){var o=t.elements[0],a={};return a.size120=n.photo120,a.size60=n.photo60,a.size24=n.photo24,a.default=n.original,(0,r.default)(u.default.put(o.userId.toString(),{data:{userId:o.userId,externalId:o.externalId,privacy:o.privacy,photos:a}})).then(function(){e.dispatch("UPDATE_PROFILE_IMAGE_SUCCESS",a)})});return(0,r.default)()}},ge5Z:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p=_interopRequireDefault(e("sbe7")),d,c=_interopRequireDefault(e("oYk5")),f,m=_interopRequireDefault(e("GP6s")),h,g=_interopRequireDefault(e("wiyT")),v,D=_interopRequireDefault(e("w/1P")),y,E=_interopRequireDefault(e("BdXV")),R,I=_interopRequireDefault(e("0mhE")),q,P=_interopRequireDefault(e("8cuT")),S,b=_interopRequireDefault(e("geam")),C,w=_interopRequireDefault(e("y1LI")),x=e("gXau");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}e("b7BL");var T=(u=s=function(e){function ImageEditor(){var t,o,n;(0,r.default)(this,ImageEditor);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return t=o=(0,a.default)(this,e.call.apply(e,[this].concat(s))),o.state={imageDataUrl:null,scale:1,uploadState:{state:"ready",progress:0},currentState:"upload"},o.handleSave=function(){var e=o.avatar.props.width,t=o.avatar.props.height,r=o.avatar.getCropPositions(),a=r.width,n=o.origImgDims.width/a,i={x1:r.x*n,y1:r.y*n,x2:r.x*n+e*n,y2:r.y*n+t*n};o.createUploader(i)},o.handleScale=function(){var e=o.scale.value;o.setState({scale:e})},o.onError=function(e){"uploading"===o.state.uploadState.state&&o.uploader.cancel(),o.setState({uploadState:{state:"error",progress:0,error:e}}),o.props.onUploadError&&o.props.onUploadError(e),o.reset()},o.onCancel=function(){o.props.onUploadCancel&&o.props.onUploadCancel()},o.onStart=function(){o.props.onUploadStart&&o.props.onUploadStart()},o.onUploadComplete=function(e,t){o.props.onUploadComplete&&o.props.onUploadComplete(e,t)},o.onResult=function(e,t){o.props.onUploadResult&&o.props.onUploadResult(e,t)},o.onSelect=function(){o.setState({uploadState:{state:"uploading",progress:0}}),o.props.onUploadSelect&&o.props.onUploadSelect()},o.onSuccess=function(e){o.setState({uploadState:{state:"uploaded",progress:100}});var t=o.props,r=t.authenticated,a=t.userId;if(!e.results[":original"])return o.handleUploadError(),void o.reset();var n={photo120:I.default.makeHttps(e.results.resize_to_120[0].url),photo60:I.default.makeHttps(e.results.resize_to_60[0].url),photo24:I.default.makeHttps(e.results.resize_to_24[0].url),original:I.default.makeHttps(e.results[":original"][0].url)};(0,g.default)(o.context.executeAction(x.updateProfileImage,{authenticated:r,userId:a,photos:n})).then(function(){o.setState({uploadState:{state:"saved",progress:100}}),setTimeout(function(){o.props.onCloseEditor()},2e3)},function(e){o.setState({uploadState:{state:"error"}})}).done()},o.onProgress=function(e){var t=e.bytes_received,r=e.bytes_expected,a=0===r?0:100*t/r;o.setState({uploadState:{state:"uploading",progress:a}}),o.props.onUploadProgress&&o.props.onUploadProgress(a)},o.onNewFile=function(){var e=o.file;if(e.files[0]){var t=new FileReader;t.readAsDataURL(e.files[0]),t.onloadend=function(e){var t=new Image;t.src=e.target.result,o.origImgDims={width:t.width,height:t.height},o.setState({currentState:"edit",imageDataUrl:e.target.result})}}},o.openFileUpload=function(){o.file.click()},o.closeEditor=function(){o.props.onCloseEditor()},n=t,(0,a.default)(o,n)}return(0,i.default)(ImageEditor,e),ImageEditor.prototype.componentDidMount=function componentDidMount(){this.openFileUpload()},ImageEditor.prototype.handleUploadError=function handleUploadError(e){this.onError(e)},ImageEditor.prototype.removeUploader=function removeUploader(){if(!this.uploader)return;this.uploader.reset(),this.uploader.off("select",this.onSelect),this.uploader.off("start",this.onStart),this.uploader.off("progress",this.onProgress),this.uploader.off("upload-complete",this.onUploadComplete),this.uploader.off("result",this.onResult),this.uploader.off("success",this.onSuccess),this.uploader.off("error",this.onError),this.uploader.off("cancel",this.onCancel),this.uploader=null},ImageEditor.prototype.reset=function reset(){this.removeUploader()},ImageEditor.prototype.createUploader=function createUploader(e){var t={wait:!0,params:{auth:{key:"05912e90e83346abb96c261bf458b615"},template_id:"8f4ad5202f0b11e5884b378d02f4564a",steps:{crop:{crop:e}}}};this.uploader=(0,E.default)(this.uploadArea,t),this.uploader.on("select",this.onSelect),this.uploader.on("start",this.onStart),this.uploader.on("progress",this.onProgress),this.uploader.on("upload-complete",this.onUploadComplete),this.uploader.on("result",this.onResult),this.uploader.on("success",this.onSuccess),this.uploader.on("error",this.onError),this.uploader.on("cancel",this.onCancel),this.uploader.$files=(0,c.default)(this.uploadArea).find("input[type=file]"),this.uploader.submit(),this.onSelect()},ImageEditor.prototype.renderImageEditing=function renderImageEditing(){var e=this;return p.default.createElement("div",null,p.default.createElement("p",{className:"headline-2-text align-horizontal-center"},(0,m.default)("Edit your photo")),p.default.createElement("div",{className:"contents"},p.default.createElement(b.default,{ref:function ref(t){e.avatar=t},rotation:this.state.rotation,scale:parseFloat(this.state.scale),onSave:this.handleSave,image:this.state.imageDataUrl}),this.renderUploadState(),"ready"===this.state.uploadState.state&&p.default.createElement("div",{className:"work-area"},p.default.createElement("input",{name:"scale",type:"range",ref:function ref(t){e.scale=t},onChange:this.handleScale,min:"1",max:"2",step:"0.01",defaultValue:"1"}),p.default.createElement("div",{className:"horizontal-box button-box align-items-absolute-center"},p.default.createElement("button",{className:"passive",onClick:this.closeEditor},(0,m.default)("Cancel")),p.default.createElement("button",{className:"secondary",onClick:this.handleSave},(0,m.default)("Save"))))))},ImageEditor.prototype.renderUploadState=function renderUploadState(){if("uploading"===this.state.uploadState.state){var e=this.state.uploadState.progress||0,t,r={width:Math.min(Math.max(e,5),95).toFixed(2)+"%"};return p.default.createElement("div",{className:"work-area"},p.default.createElement("div",{className:"bt3-progress"},p.default.createElement("div",{className:"bt3-progress-bar",style:r})),p.default.createElement("div",{className:"color-hint-text label-text align-horizontal-center"},(0,m.default)("Uploading ...")))}if("saved"===this.state.uploadState.state)return p.default.createElement("div",{className:"work-area horizontal-box align-items-absolute-center saved"},p.default.createElement(w.default,{name:"checkmark",className:"cif-fw"}),(0,m.default)("Your photo is saved!"));return},ImageEditor.prototype.renderErrorState=function renderErrorState(){if("error"===this.state.uploadState.state)return p.default.createElement("div",{className:"caption-text error"},(0,m.default)("Sorry, something went wrong. Please try again."));return},ImageEditor.prototype.renderUploadButton=function renderUploadButton(){var e=this,t=(0,D.default)("vertical-box","align-items-absolute-center",{hide:"upload"!==this.state.currentState});return p.default.createElement("div",{className:t,ref:function ref(t){e.uploadArea=t}},p.default.createElement("input",{id:"upload-file-input",type:"file",name:"file",ref:function ref(t){e.file=t},multiple:"false",className:"upload-file-input",onChange:this.onNewFile,accept:"image/x-png, image/gif, image/jpeg"}),p.default.createElement("label",{htmlFor:"upload-file-input",className:"upload-button-label align-horizontal-center"},(0,m.default)("Upload Photo")))},ImageEditor.prototype.render=function render(){return p.default.createElement("section",{className:"rc-ImageEditor vertical-box align-items-absolute-center"},this.renderUploadButton(),"edit"===this.state.currentState&&this.renderImageEditing(),this.renderErrorState())},ImageEditor}(p.default.Component),s.propTypes={onCloseEditor:p.default.PropTypes.func.isRequired,onUploadCancel:p.default.PropTypes.func,onUploadError:p.default.PropTypes.func,onUploadStart:p.default.PropTypes.func,onUploadComplete:p.default.PropTypes.func,onUploadResult:p.default.PropTypes.func,onUploadSelect:p.default.PropTypes.func,onUploadProgress:p.default.PropTypes.func,userId:p.default.PropTypes.number,authenticated:p.default.PropTypes.bool},s.contextTypes={executeAction:p.default.PropTypes.func.isRequired},u);module.exports=(0,P.default)(T,["ApplicationStore","ProfileStore"],function(e){var t=e.ApplicationStore,r=e.ProfileStore;return{authenticated:t.isAuthenticatedUser(),userId:t.getUserData().id}})},geBo:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u=_interopRequireDefault(e("QbLZ")),l,p,d,c=_interopRequireDefault(e("sbe7")),f=e("VYij"),m,h=_interopRequireDefault(e("ngyh")),g,v=_interopRequireDefault(e("+LJP")),D,y=_interopRequireDefault(e("8cuT")),E,R=_interopRequireDefault(e("pqXt")),I,q=_interopRequireDefault(e("TpA2")),P,S=_interopRequireDefault(e("jzks")),b,C=_interopRequireDefault(e("oQ9N")),w,x=_interopRequireDefault(e("KMW/")),T,U=_interopRequireDefault(e("UU2Q"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var A=function discussionPromptContainer(){return x.default.get("UngradedDiscussionPrompts","learnerEnabled")?q.default:S.default},M=(0,f.compose)((0,C.default)({fields:["forumType","urlId"]}),(0,v.default)(function(e,t){return(0,u.default)({},(0,R.default)(e,t),{page:e.location.query.page?parseInt(e.location.query.page,10):1,answerId:e.location.query.answerId?e.location.query.answerId:void 0})}),(0,y.default)(["ThreadDetailsStore"],function(e,t){var r=e.ThreadDetailsStore,o=t.itemMetadata;return{savingStates:Object.assign({},r.savingStates)}}))(A());module.exports=(p=l=function(e){function FluxibleConnectedDiscussionPrompt(){return(0,r.default)(this,FluxibleConnectedDiscussionPrompt),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(FluxibleConnectedDiscussionPrompt,e),FluxibleConnectedDiscussionPrompt.prototype.componentWillMount=function componentWillMount(){this.fluxibleContext=(0,U.default)(this.context.fluxibleContext)},FluxibleConnectedDiscussionPrompt.prototype.render=function render(){return c.default.createElement(h.default,{context:this.fluxibleContext.getComponentContext()},c.default.createElement(M,this.props))},FluxibleConnectedDiscussionPrompt}(c.default.Component),l.contextTypes={fluxibleContext:c.default.PropTypes.object},p)},geam:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p=_interopRequireDefault(e("sbe7")),d,c=_interopRequireDefault(e("i8i4"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var f="ontouchstart"in window||navigator.msMaxTouchPoints>0,m={mobile:{react:{down:"onTouchStart",drag:"onTouchMove",drop:"onTouchEnd",move:"onTouchMove",up:"onTouchUp"},native:{down:"touchstart",drag:"touchmove",drop:"touchend",move:"touchmove",up:"touchup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",drop:"onDrop",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",drop:"drop",move:"mousemove",up:"mouseup"}}},h=f?m.mobile:m.desktop,g=(u=s=function(e){function ReactAvatarEditor(){var t,o,n;(0,r.default)(this,ReactAvatarEditor);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return t=o=(0,a.default)(this,e.call.apply(e,[this].concat(s))),o.state={drag:!1,my:null,mx:null,image:{x:0,y:0}},o.handleDragOver=function(e){e.preventDefault()},o.handleUploadReady=function(e){o.loadImage(e.target.result)},o.handleMouseMove=function(e){if(0==o.state.drag)return;var t=o.state.image,r=t.x,a=t.y,n=f?event.targetTouches[0].pageX:e.clientX,i=f?event.targetTouches[0].pageY:e.clientY,s={mx:n,my:i,image:t};if(o.state.mx&&o.state.my){var u=o.state.mx-n,l=o.state.my-i;t.y=o.getBoundedY(a-l,o.props.scale),t.x=o.getBoundedX(r-u,o.props.scale)}o.setState(s)},o.handleDrop=function(e){e.stopPropagation(),e.preventDefault();var t=new FileReader;t.onload=o.handleUploadReady,t.readAsDataURL(e.dataTransfer.files[0])},o.handleMouseUp=function(){o.state.drag&&o.setState({drag:!1})},o.handleMouseDown=function(){o.setState({drag:!0,mx:null,my:null})},o.handleImageReady=function(e){var t=o.getInitialSize(e.width,e.height);t.resource=e,t.x=o.props.border,t.y=o.props.border,o.setState({drag:!1,image:t},o.props.onImageReady)},n=t,(0,a.default)(o,n)}return(0,i.default)(ReactAvatarEditor,e),ReactAvatarEditor.prototype.componentDidMount=function componentDidMount(){var e=c.default.findDOMNode(this).getContext("2d");this.props.image&&this.loadImage(this.props.image),this.paint(e),document&&document.addEventListener(h.native.move,this.handleMouseMove,!1),document&&document.addEventListener(h.native.up,this.handleMouseUp,!1)},ReactAvatarEditor.prototype.componentWillReceiveProps=function componentWillReceiveProps(e){this.props.image!=e.image&&this.loadImage(e.image),this.props.scale!=e.scale&&this.squeeze(e)},ReactAvatarEditor.prototype.componentDidUpdate=function componentDidUpdate(){var e=c.default.findDOMNode(this).getContext("2d");e.clearRect(0,0,this.getDimensions().canvas.width,this.getDimensions().canvas.height),this.paint(e),this.paintImage(e,this.state.image)},ReactAvatarEditor.prototype.componentWillUnmount=function componentWillUnmount(){document&&document.removeEventListener(h.native.move,this.handleMouseMove,!1),document&&document.removeEventListener(h.native.up,this.handleMouseUp,!1)},ReactAvatarEditor.prototype.getCropPositions=function getCropPositions(){var e=this.getDimensions(),t=this.state.image;return{x:-1*t.x+e.border,y:-1*t.y+e.border,width:t.width*this.props.scale,height:t.height*this.props.scale}},ReactAvatarEditor.prototype.getInitialSize=function getInitialSize(e,t){var r=void 0,o=void 0,a=void 0,n=void 0,i=void 0;return(r=(o=this.getDimensions()).height/o.width)>(a=t/e)?i=e*((n=this.getDimensions().height)/t):n=t*((i=this.getDimensions().width)/e),{height:n,width:i}},ReactAvatarEditor.prototype.getImage=function getImage(e,t){var r=document.createElement("canvas"),o=r.getContext("2d"),a=this.getDimensions();r.width=a.width,r.height=a.height,o.globalCompositeOperation="destination-over";var n=this.state.image;return this.paintImage(o,{resource:n.resource,x:n.x-a.border,y:n.y-a.border,width:n.width,height:n.height}),r.toDataURL(e,t)},ReactAvatarEditor.prototype.getDimensions=function getDimensions(){return{width:this.props.width,height:this.props.height,border:this.props.border,canvas:{width:this.props.width+2*this.props.border,height:this.props.height+2*this.props.border}}},ReactAvatarEditor.prototype.getBoundedY=function getBoundedY(e,t){var r=this.state.image,o=this.getDimensions(),a=Math.ceil((r.height*t-r.height)/2),n=Math.ceil(-r.height*t+o.height+o.border),i=o.border,s=void 0;return e-a>=o.border&&(s=o.border+a),e<n&&(s=n),e>i&&(s=i),s||e},ReactAvatarEditor.prototype.getBoundedX=function getBoundedX(e,t){var r=this.state.image,o=this.getDimensions(),a=Math.ceil((r.width*t-r.width)/2),n=Math.ceil(-r.width*t+o.width+o.border),i=o.border,s=void 0;return e-a>=o.border&&(s=o.border+a),e<n&&(s=n),e>i&&(s=i),s||e},ReactAvatarEditor.prototype.isDataURL=function isDataURL(e){var t=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i;return!!e.match(t)},ReactAvatarEditor.prototype.paint=function paint(e){e.save(),e.translate(0,0),e.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var t=this.getDimensions(),r=t.border,o=t.canvas.height,a=t.canvas.width;e.fillRect(0,0,a,r),e.fillRect(0,o-r,a,r),e.fillRect(0,r,r,o-2*r),e.fillRect(a-r,r,r,o-2*r),e.restore()},ReactAvatarEditor.prototype.squeeze=function squeeze(e){var t=this.state.image;t.y=this.getBoundedY(t.y,e.scale),t.x=this.getBoundedX(t.x,e.scale),this.setState({image:t})},ReactAvatarEditor.prototype.calculatePosition=function calculatePosition(e){e=e||this.state.image;var t=void 0,r=void 0,o=void 0,a=void 0,n=this.getDimensions();r=e.width*this.props.scale,t=e.height*this.props.scale;var i=(r-e.width)/2,s=(t-e.height)/2;o=e.x-i,a=e.y-s,o=Math.min(o,n.border);var u=t+((a=Math.min(a,n.border))-n.border);a=u>n.height?a:a+(n.height-u);var l=r+(o-n.border);return{x:o=l>n.width?o:o+(n.width-l),y:a,height:t,width:r}},ReactAvatarEditor.prototype.paintImage=function paintImage(e,t){if(t.resource){var r=this.calculatePosition(t);e.save(),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,t.x,t.y,r.width,r.height),e.restore()}},ReactAvatarEditor.prototype.loadImage=function loadImage(e){var t=new Image;t.onload=this.handleImageReady.bind(this,t),this.isDataURL(e)||(t.crossOrigin="anonymous"),t.src=e},ReactAvatarEditor.prototype.render=function render(){var e={width:this.getDimensions().canvas.width,height:this.getDimensions().canvas.height,style:this.props.style};return e[h.react.down]=this.handleMouseDown,e[h.react.drag]=this.handleDragOver,e[h.react.drop]=this.handleDrop,p.default.createElement("canvas",e)},ReactAvatarEditor}(p.default.Component),s.propTypes={scale:p.default.PropTypes.number,image:p.default.PropTypes.string,border:p.default.PropTypes.number,width:p.default.PropTypes.number,height:p.default.PropTypes.number,color:p.default.PropTypes.arrayOf(p.default.PropTypes.number),onImageReady:p.default.PropTypes.func,style:p.default.PropTypes.object},s.defaultProps={scale:1,border:25,width:200,height:200,color:[0,0,0,.5],onImageReady:function onImageReady(){},style:{}},u);module.exports=g},jzks:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("VYij")),o,a=_interopRequireDefault(e("PStO")),n,i=_interopRequireDefault(e("jsrg")),s,u=_interopRequireDefault(e("VXRf")),l,p=_interopRequireDefault(e("23qH")),d=e("SaLm"),c,f=_interopRequireDefault(e("bmRM"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var m=r.default.compose(a.default.createContainer(function(e){var t=e.userId,r=e.itemMetadata,o=r.getId(),a=r.get("course").get("id");return{legacyDiscussionQuestionResults:p.default.finder("byPromptItem",{params:{courseId:a,itemId:o,sort:d.answerSorts.newestSort}})}}),(0,i.default)(function(e){var t;return!!e.legacyDiscussionQuestionResults}),(0,u.default)(function(e){var t=e.legacyDiscussionQuestionResults,o=(0,r.default)(t).first(),a=o&&o.id,n;return{isLoaded:!0,questionId:a,question:{id:a,questionId:a,type:"question",forumType:d.naptimeForumTypes.rootForumType},promptContent:o&&o.content.details,learnerCount:o&&(o.answerCount||o.topLevelAnswerCount)}}))(f.default);module.exports=m},l4M5:function(module,exports,e){var t=e("afBN"),r;"string"==typeof t&&(t=[[module.i,t,""]]);var o={transform:void 0},a=e("aET+")(t,o);t.locals&&(module.exports=t.locals)},m88N:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p=_interopRequireDefault(e("sbe7")),d,c=_interopRequireDefault(e("sQ/U")),f,m=_interopRequireDefault(e("pJdi")),h,g=_interopRequireDefault(e("tniC")),v,D=_interopRequireDefault(e("g21z"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var y=(u=s=function(e){function ProfileImageUploader(){var t,o,n;(0,r.default)(this,ProfileImageUploader);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return t=o=(0,a.default)(this,e.call.apply(e,[this].concat(s))),o.state={showModal:!1},o.onImageEditorClick=function(){o.setState({showModal:!0})},o.editingComplete=function(){o.setState({showModal:!1})},n=t,(0,a.default)(o,n)}return(0,i.default)(ProfileImageUploader,e),ProfileImageUploader.prototype.render=function render(){var e=c.default.get().photo_120;return p.default.createElement("div",{className:"rc-ProfileImageUploader"},e?p.default.createElement(D.default,{profileImageUrl:e,width:36,height:36}):p.default.createElement("div",null,p.default.createElement(m.default,{onButtonClick:this.onImageEditorClick,mini:this.props.mini}),this.state.showModal&&p.default.createElement(g.default,{onEditingComplete:this.editingComplete})))},ProfileImageUploader}(p.default.Component),s.propTypes={mini:p.default.PropTypes.bool},u);module.exports=y},ma43:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("CWYE")),o,a=_interopRequireDefault(e("0jv7"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}module.exports=(0,r.default)(a.default.profileApi,{type:"rest"}),module.exports.externalPublicProfileApi=(0,r.default)(a.default.externalPublicProfileApi,{type:"rest"})},pJdi:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p=_interopRequireDefault(e("sbe7")),d,c=_interopRequireDefault(e("y1LI")),f=e("6gRZ"),m,h=_interopRequireDefault(e("w/1P")),g,v=_interopRequireDefault(e("GP6s"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}e("HKJh");var D=(u=s=function(e){function ImageEditorButton(){var t,o,n;(0,r.default)(this,ImageEditorButton);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return t=o=(0,a.default)(this,e.call.apply(e,[this].concat(s))),o.openFileUploader=function(){o.props.onButtonClick()},n=t,(0,a.default)(o,n)}return(0,i.default)(ImageEditorButton,e),ImageEditorButton.prototype.render=function render(){var e=(0,h.default)("rc-ImageEditorButton",{mini:this.props.mini}),t=(0,h.default)("color-primary-text",{"cif-2x":!this.props.mini,"cif-fw":this.props.mini}),r=p.default.createElement(f.Tooltip,null,p.default.createElement("span",null,(0,v.default)("Upload photo")));return p.default.createElement("section",{className:e},p.default.createElement(f.OverlayTrigger,{placement:"right",overlay:r},p.default.createElement("button",{className:"passive camera theme-light",onClick:this.openFileUploader},p.default.createElement(c.default,{name:"camera",className:t}))))},ImageEditorButton}(p.default.Component),s.propTypes={onButtonClick:p.default.PropTypes.func.isRequired,mini:p.default.PropTypes.bool},u);module.exports=D},soQW:function(module,exports,e){},t1rh:function(module,exports,e){},tniC:function(module,exports,e){"use strict";var t,r=_interopRequireDefault(e("iCc5")),o,a=_interopRequireDefault(e("FYw3")),n,i=_interopRequireDefault(e("mRg0")),s,u,l,p=_interopRequireDefault(e("sbe7")),d,c=_interopRequireDefault(e("CQyo")),f,m=_interopRequireDefault(e("YCpq")),h,g=_interopRequireDefault(e("ge5Z"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}e("l4M5");var v=(u=s=function(e){function ImageEditorModal(){var t,o,n;(0,r.default)(this,ImageEditorModal);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return t=o=(0,a.default)(this,e.call.apply(e,[this].concat(s))),o.closeModal=function(){o.props.onEditingComplete()},n=t,(0,a.default)(o,n)}return(0,i.default)(ImageEditorModal,e),ImageEditorModal.prototype.render=function render(){return p.default.createElement("div",{className:"rc-ImageEditorModal"},p.default.createElement(c.default,{handleClose:this.closeModal,ref:"editPhoto"},p.default.createElement(g.default,{onCloseEditor:this.closeModal})))},ImageEditorModal}(p.default.Component),s.propTypes={onEditingComplete:p.default.PropTypes.func.isRequired},u);module.exports=v}}]);
//# sourceMappingURL=7.2c7cd00478af99879ccf.js.map